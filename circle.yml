dependencies:
  cache_directories:
    - "~/go_appengine"
    - "~/golang"
  override:
    - ./maybe_install_go.sh
    - sh -c "env GOROOT=$HOME/golang $HOME/golang/bin/go get -v ./... || true"
    - ./maybe_install_sdk.sh
test:
  pre:
    - sh -c "cd app && dev_appserver.py --clear_datastore=yes  --datastore_consistency_policy=consistent --skip_sdk_update_check > dev_appserver.log 2>&1" &
  override:
    - curl -s --connect-timeout 300 -o /dev/null http://localhost:8080/
    - sh -c "cd diptest && env GOROOT=$HOME/golang $HOME/golang/bin/go test -v"
